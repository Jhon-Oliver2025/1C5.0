<!DOCTYPE html>
<html>
<head>
    <title>Corrigir Token - Solu√ß√£o Final</title>
</head>
<body>
    <h1>üîß Corrigindo Token...</h1>
    <div id="status">Processando...</div>
    
    <script>
        console.log('=== DIAGN√ìSTICO DO TOKEN ===');
        console.log('Token atual:', localStorage.getItem('token'));
        console.log('User atual:', localStorage.getItem('user'));
        
        // Token v√°lido confirmado que funciona
        const VALID_TOKEN = '09a9deb1-47d3-4386-b123-e971650fee61';
        const VALID_USER = {
            "email": "jonatasprojetos2013@gmail.com",
            "id": "86bab845-1921-43b8-bdf7-b13fb17efdc8",
            "is_admin": true,
            "username": "admin"
        };
        
        function updateStatus(message) {
            document.getElementById('status').innerHTML = message;
            console.log(message);
        }
        
        function fixToken() {
            updateStatus('üóëÔ∏è Limpando dados antigos...');
            
            // Limpar TUDO do localStorage
            localStorage.clear();
            
            setTimeout(() => {
                updateStatus('‚úÖ Definindo token v√°lido...');
                
                // Definir o token v√°lido
                localStorage.setItem('token', VALID_TOKEN);
                localStorage.setItem('user', JSON.stringify(VALID_USER));
                
                setTimeout(() => {
                    updateStatus('üîç Verificando token...');
                    
                    const newToken = localStorage.getItem('token');
                    const newUser = localStorage.getItem('user');
                    
                    console.log('=== AP√ìS CORRE√á√ÉO ===');
                    console.log('Novo token:', newToken);
                    console.log('Novo user:', newUser);
                    
                    if (newToken === VALID_TOKEN) {
                        updateStatus('‚úÖ Token corrigido com sucesso!');
                        
                        setTimeout(() => {
                            updateStatus('üîÑ Redirecionando para BTC Analysis...');
                            window.location.href = 'http://localhost:3000/btc-analysis';
                        }, 1000);
                    } else {
                        updateStatus('‚ùå Erro: Token n√£o foi definido corretamente');
                    }
                }, 500);
            }, 500);
        }
        
        // Executar corre√ß√£o
        setTimeout(fixToken, 1000);
    </script>
    
    <div style="margin-top: 20px; padding: 15px; background: #f0f0f0; border-radius: 8px;">
        <h3>üîß Diagn√≥stico:</h3>
        <p><strong>Problema:</strong> Token inv√°lido no localStorage</p>
        <p><strong>Token Atual:</strong> 88c45f52-187b-4b2a-8ceb-d0ded221dcf9 (INV√ÅLIDO)</p>
        <p><strong>Token Correto:</strong> 09a9deb1-47d3-4386-b123-e971650fee61</p>
        <p><strong>Solu√ß√£o:</strong> Substituindo token automaticamente...</p>
    </div>
</body>
</html>